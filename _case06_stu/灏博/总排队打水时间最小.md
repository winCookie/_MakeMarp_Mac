### 总排队打水时间最小

▍定理  

设有 $n$ 个人排队打水，打水时间分别为 $a_1, a_2, \dots, a_n$。总排队打水时间定义为所有人完成打水的时间之和，即若打水顺序为 $p_1, p_2, \dots, p_n$，则总时间为 $T = \sum_{k=1}^n \sum_{i=1}^k a_{p_i}$。总时间最小当且仅当打水时间按从小到大排列，即 $a_1 \leq a_2 \leq \dots \leq a_n$。

▍证明（数学归纳法）  

我们使用数学归纳法证明该定理。

- **基础步骤**（$n=1$ 和 $n=2$）：  
  
  - 当 $n=1$ 时，只有一个人，总时间即为 $a_1$，显然成立。  
  - 当 $n=2$ 时，设打水时间为 $a_1$ 和 $a_2$，且假设 $a_1 \leq a_2$。比较两种顺序：  
    - 顺序 $a_1, a_2$：总时间 $T_1 = a_1 + (a_1 + a_2) = 2a_1 + a_2$。  
    - 顺序 $a_2, a_1$：总时间 $T_2 = a_2 + (a_2 + a_1) = 2a_2 + a_1$。  
    则 $T_1 - T_2 = (2a_1 + a_2) - (2a_2 + a_1) = a_1 - a_2 \leq 0$，故 $T_1 \leq T_2$，顺序 $a_1, a_2$ 更优。基础步骤成立。
  
- **归纳假设**：  
  
  假设对于 $k < n$，定理成立，即对于少于 $n$ 个人，打水时间从小到大排列时总时间最小。
  
- **归纳步骤**（$n$ 个人）：  
  
  考虑任意打水顺序 $p_1, p_2, \dots, p_n$。若该顺序不是从小到大排列，则存在相邻两人 $p_i$ 和 $p_{i+1}$ 满足 $a_{p_i} > a_{p_{i+1}}$（即逆序对）。我们证明交换 $p_i$ 和 $p_{i+1}$ 会减少总时间。  
  设交换前顺序为 $\dots, p_i, p_{i+1}, \dots$，交换后顺序为 $\dots, p_{i+1}, p_i, \dots$。设 $p_i$ 和 $p_{i+1}$ 之前所有人的打水时间之和为 $S$。则：  
  
  - 交换前，$p_i$ 和 $p_{i+1}$ 的完成时间分别为 $S + a_{p_i}$ 和 $S + a_{p_i} + a_{p_{i+1}}$，贡献为 
      $$
      (S + a_{p_i}) + (S + a_{p_i} + a_{p_{i+1}}) = 2S + 2a_{p_i} + a_{p_{i+1}}
      $$
  
  - 交换后，$p_{i+1}$ 和 $p_i$ 的完成时间分别为 $S + a_{p_{i+1}}$ 和 $S + a_{p_{i+1}} + a_{p_i}$，贡献为 
    $$
    (S + a_{p_{i+1}}) + (S + a_{p_{i+1}} + a_{p_i}) = 2S + 2a_{p_{i+1}} + a_{p_i}
    交换前后总时间的变化量为：
    $$
  $$
  \Delta T = (2S + 2a_{p_{i+1}} + a_{p_i}) - (2S + 2a_{p_i} + a_{p_{i+1}}) = a_{p_{i+1}} - a_{p_i} < 0
  $$
  因为 $a_{p_i} > a_{p_{i+1}}$，所以 $\Delta T < 0$，即交换后总时间减少。  
  
  因此，任何存在逆序对的顺序都不是最优的。由归纳假设，第一个位置应放置最小打水时间，剩余 $n-1$ 个人按从小到大排列，故整体顺序为从小到大时总时间最小。
  
- **结论**：  
  
  由数学归纳法，定理得证。

▍示例

取 $a_1 = 8$, $a_2 = 4$, $a_3 = 10$，且 $a_2 < a_1 < a_3$。  

- 顺序 $a_1, a_2, a_3$：总时间部分 $V_1 = 2a_1 + a_2 = 2 \times 8 + 4 = 20$。  

- 顺序 $a_2, a_1, a_3$：总时间部分 $V_2 = 2a_2 + a_1 = 2 \times 4 + 8 = 16$。  

  比较 $V_2 - V_1 = 16 - 20 = -4 \leq 0$，且 $a_2 - a_1 = 4 - 8 = -4 \leq 0$，成立。故顺序 $a_2, a_1, a_3$ 更优，验证了交换逆序对减少总时间。

